<!-- Extrait JS à coller dans admin.html (dans <script type="module">) -->
<script type="module">
import { getFirestore, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";
const db = getFirestore();

// messagePath examples:
// "general/<docId>"
// "classes/3B/messages/<docId>"

async function deleteByPath(messagePath){
  const parts = messagePath.split('/').filter(Boolean);
  if(parts.length % 2 !== 0){
    // parts length should be even: collection/doc/collection/doc...
    console.error('Invalid messagePath', messagePath);
    return;
  }
  // build ref: doc(db, parts[0], parts[1], parts[2], parts[3], ...)
  const args = [db];
  for(const p of parts) args.push(p);
  try{
    await deleteDoc(doc(...args));
    console.log('Message supprimé:', messagePath);
  }catch(e){
    console.error('Delete failed', e);
    alert('Erreur suppression: ' + (e.message || e));
  }
}

// Example: on click of "Supprimer message" button created from a report:
// deleteByPath(report.messagePath);
</script>
